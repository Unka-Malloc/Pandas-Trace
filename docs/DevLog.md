# Waiting for verification
1. Q2 (Suspended: Waiting for minimum promotion implementation by Hesam)
2. Q9 (Issue: Query provided by Hesam FAILED)
3. Q11 
4. Q20
5. Q21
6. Q22

# Q9 Issue
```
{ { "nation": "KENYA", "o_year": 1996, "sum_profit": 38768.7582 }: True, 
    { "nation": "MOROCCOMOROCCOMOROCCOMOROCCO", "o_year": 1995, "sum_profit": -185177.82640000002 }: True, 
    { "nation": "PERU", "o_year": 1995, "sum_profit": 33613.0776 }: True, 
    { "nation": "UNITED KINGDOMUNITED KINGDOMUNITED KINGDOMUNITED KINGDOM", "o_year": 1995, "sum_profit": -123061.31039999994 }: True,
    { "nation": "UNITED STATES", "o_year": 1996, "sum_profit": 56125.46000000001 }: True, 
    { "nation": "UNITED KINGDOMUNITED KINGDOMUNITED KINGDOMUNITED KINGDOM", "o_year": 1994, "sum_profit": -61825.60799999999 }: True,
    { "nation": "PERUPERU", "o_year": 1998, "sum_profit": -3272.7752000000146 }: True, 
    { "nation": "MOROCCOMOROCCOMOROCCOMOROCCO", "o_year": 1998, "sum_profit": -65072.47280000001 }: True, 
    { "nation": "IRAN", "o_year": 1996, "sum_profit": 7428.232500000005 }: True, 
    { "nation": "KENYA", "o_year": 1992, "sum_profit": 72567.48300000001 }: True, 
    { "nation": "IRAQ", "o_year": 1997, "sum_profit": 47910.246 }: True, 
    { "nation": "UNITED KINGDOM", "o_year": 1992, "sum_profit": 12035.920000000006 }: True, 
    { "nation": "MOROCCOMOROCCOMOROCCOMOROCCO", "o_year": 1997, "sum_profit": -34342.246 }: True, 
    { "nation": "UNITED KINGDOMUNITED KINGDOMUNITED KINGDOMUNITED KINGDOM", "o_year": 1993, "sum_profit": -174061.46399999992 }: True,
    { "nation": "MOROCCOMOROCCOMOROCCOMOROCCO", "o_year": 1993, "sum_profit": -94153.98280000001 }: True, 
    { "nation": "ARGENTINA", "o_year": 1995, "sum_profit": 20892.752500000002 }: True,
    { "nation": "KENYA", "o_year": 1993, "sum_profit": 88401.6928 }: True, 
    { "nation": "ARGENTINA", "o_year": 1993, "sum_profit": 17586.344600000004 }: True,
    { "nation": "KENYAKENYA", "o_year": 1995, "sum_profit": -7892.828700000004 }: True, 
    { "nation": "ARGENTINA", "o_year": 1994, "sum_profit": 15088.352599999998 }: True, 
    { "nation": "IRAQ", "o_year": 1993, "sum_profit": 30687.2625 }: True, 
    { "nation": "PERUPERU", "o_year": 1995, "sum_profit": -10207.388800000019 }: True,
    { "nation": "MOROCCOMOROCCOMOROCCOMOROCCO", "o_year": 1992, "sum_profit": -156795.5612 }: True,
    { "nation": "MOROCCO", "o_year": 1997, "sum_profit": 12268.244999999999 }: True, 
    { "nation": "UNITED STATES", "o_year": 1998, "sum_profit": 32847.96 }: True, 
    { "nation": "IRAN", "o_year": 1993, "sum_profit": 49876.41499999999 }: True, 
    { "nation": "IRAQ", "o_year": 1996, "sum_profit": 18459.567499999997 }: True, 
    { "nation": "MOROCCO", "o_year": 1993, "sum_profit": 22313.6115 }: True, 
    { "nation": "UNITED KINGDOM", "o_year": 1998, "sum_profit": 34717.46000000001 }: True, 
    { "nation": "MOROCCO", "o_year": 1995, "sum_profit": 9583.272400000002 }: True, 
    { "nation": "IRAQ", "o_year": 1995, "sum_profit": 32782.37010000001 }: True, 
    { "nation": "MOROCCO", "o_year": 1992, "sum_profit": 9907.59 }: True, 
    { "nation": "ETHIOPIA", "o_year": 1994, "sum_profit": 37251.01 }: True,
    { "nation": "IRAQ", "o_year": 1992, "sum_profit": 29098.2557 }: True, 
    { "nation": "KENYA", "o_year": 1995, "sum_profit": 60792.811200000004 }: True, 
    { "nation": "ARGENTINA", "o_year": 1998, "sum_profit": 17779.069700000007 }: True, 
    { "nation": "UNITED KINGDOMUNITED KINGDOMUNITED KINGDOMUNITED KINGDOM", "o_year": 1996, "sum_profit": -74449.78719999998 }: True, 
    { "nation": "MOROCCO", "o_year": 1996, "sum_profit": 1215.980000000005 }: True, 
    { "nation": "UNITED KINGDOM", "o_year": 1993, "sum_profit": 2567.7200000000003 }: True, 
    { "nation": "MOROCCOMOROCCOMOROCCOMOROCCO", "o_year": 1994, "sum_profit": -113493.51160000003 }: True, 
    { "nation": "UNITED KINGDOM", "o_year": 1997, "sum_profit": 4961.333 }: True, 
    { "nation": "KENYA", "o_year": 1994, "sum_profit": 81951.40429999998 }: True, 
    { "nation": "UNITED KINGDOMUNITED KINGDOMUNITED KINGDOMUNITED KINGDOM", "o_year": 1998, "sum_profit": -24307.50399999999 }: True, 
    { "nation": "KENYA", "o_year": 1997, "sum_profit": 54355.016500000005 }: True, 
    { "nation": "PERUPERU", "o_year": 1996, "sum_profit": -1225.7591000000057 }: True, 
    { "nation": "PERUPERU", "o_year": 1992, "sum_profit": -3855.386800000002 }: True, 
    { "nation": "PERU", "o_year": 1997, "sum_profit": 49380.162800000006 }: True, 
    { "nation": "PERU", "o_year": 1992, "sum_profit": 42599.1452 }: True, 
    { "nation": "IRAN", "o_year": 1992, "sum_profit": 52064.24 }: True, 
    { "nation": "PERUPERU", "o_year": 1993, "sum_profit": -4056.460800000008 }: True, 
    { "nation": "IRAN", "o_year": 1994, "sum_profit": 29408.13 }: True, 
    { "nation": "UNITED STATES", "o_year": 1994, "sum_profit": 31671.2 }: True, 
    { "nation": "MOROCCO", "o_year": 1994, "sum_profit": 6853.679999999999 }: True, 
    { "nation": "ETHIOPIA", "o_year": 1995, "sum_profit": 37720.35 }: True, 
    { "nation": "UNITED KINGDOMUNITED KINGDOMUNITED KINGDOMUNITED KINGDOM", "o_year": 1992, "sum_profit": -17189.729599999995 }: True, 
    { "nation": "UNITED STATES", "o_year": 1997, "sum_profit": 30849.5 }: True, 
    { "nation": "IRAN", "o_year": 1997, "sum_profit": 23590.007999999998 }: True, 
    { "nation": "UNITED KINGDOM", "o_year": 1996, "sum_profit": 21335.6372 }: True, 
    { "nation": "KENYAKENYA", "o_year": 1994, "sum_profit": -9697.436599999997 }: True, 
    { "nation": "ETHIOPIA", "o_year": 1993, "sum_profit": 23782.61 }: True, 
    { "nation": "IRAQ", "o_year": 1994, "sum_profit": 9041.2317 }: True, 
    { "nation": "MOROCCO", "o_year": 1998, "sum_profit": 11731.923999999999 }: True, 
    { "nation": "PERU", "o_year": 1994, "sum_profit": 55023.063200000004 }: True, 
    { "nation": "KENYAKENYA", "o_year": 1992, "sum_profit": -29219.416 }: True, 
    { "nation": "UNITED KINGDOM", "o_year": 1995, "sum_profit": 3240.4400000000023 }: True, 
    { "nation": "PERU", "o_year": 1996, "sum_profit": 10987.57 }: True, 
    { "nation": "UNITED KINGDOMUNITED KINGDOMUNITED KINGDOMUNITED KINGDOM", "o_year": 1997, "sum_profit": -41079.020799999984 }: True, 
    { "nation": "PERU", "o_year": 1993, "sum_profit": 55895.26789999999 }: True, 
    { "nation": "ARGENTINA", "o_year": 1996, "sum_profit": 7641.422700000003 }: True, 
    { "nation": "UNITED STATES", "o_year": 1992, "sum_profit": 51970.23 }: True, 
    { "nation": "MOROCCOMOROCCOMOROCCOMOROCCO", "o_year": 1996, "sum_profit": -104164.25320000004 }: True,
    { "nation": "PERUPERU", "o_year": 1997, "sum_profit": -872.433100000002 }: True, 
    { "nation": "UNITED STATES", "o_year": 1993, "sum_profit": 55057.469 }: True, 
    { "nation": "ARGENTINA", "o_year": 1992, "sum_profit": 28732.461499999994 }: True, 
    { "nation": "UNITED STATES", "o_year": 1995, "sum_profit": 15961.7977 }: True, 
    { "nation": "IRAN", "o_year": 1995, "sum_profit": 21000.996499999994 }: True, 
    { "nation": "PERU", "o_year": 1998, "sum_profit": 1378.8899999999999 }: True, 
    { "nation": "KENYAKENYA", "o_year": 1996, "sum_profit": -4909.106400000001 }: True, 
    { "nation": "KENYA", "o_year": 1998, "sum_profit": 33148.3345 }: True, 
    { "nation": "KENYAKENYA", "o_year": 1993, "sum_profit": -6917.377200000003 }: True, 
    { "nation": "ETHIOPIA", "o_year": 1996, "sum_profit": 33970.65 }: True, 
    { "nation": "ETHIOPIA", "o_year": 1998, "sum_profit": 28217.159999999996 }: True, 
    { "nation": "ARGENTINA", "o_year": 1997, "sum_profit": 13943.953800000003 }: True, 
    { "nation": "IRAQ", "o_year": 1998, "sum_profit": 11619.960399999996 }: True 
}
```

# Apply
1. Q8
2. Q14
4. Q17

# Seems like not implemented
1. min in Q2
2. max in Q15
3. Q16: if a dict `d` is None, then `d[0]` should be None, and `d[0].a` should also be None.

# Q5
Exceptionally difficult implementation.  
Easy query, hard inference.

# Q7
Columns renaming and multi hash join.

ExtFunc not defined.

# Q8
Not allowed: Use ConstantExpr(True) as value if empty.
```
DicConsExpr([(RecAccessExpr(PairAccessExpr(x_re, 0), 'r_regionkey'), 
              ConstantExpr(True))])
```

```
DicConsExpr([(RecAccessExpr(PairAccessExpr(v1, 0), 'r_regionkey'), 
              RecConsExpr([('r_regionkey', RecAccessExpr(PairAccessExpr(v1, 0), 'r_regionkey'))]))])
```

Why not probe on `[cu, ord]`?

Why no 
```
CompareExpr(CompareSymbol.NE, 
    DicLookupExpr(re_na_cu, RecAccessExpr(PairAccessExpr(x_ord, 0), 'o_custkey')), 
    ConstantExpr(None)
```

Multiple key-value index : `DicLookupExpr(DicLookupExpr(DicLookupExpr())))`

Reconstruct from dict: 

```
('n_nationkey', 
    RecAccessExpr(DicLookupExpr(re_na_cu, RecAccessExpr(PairAccessExpr(x_ord, 0), 'o_custkey')), 'n_nationkey'))
```

# Q1
GroupbyAggrFrame

# Q6
AggrFrame

# Q4
IsInExpr
GroupbyAggrFrame

Error: 
    1. Variable Not Defined (lineitem_part). 
        This could be fixed in GroupbyAggrFrame, by adding context_variables from isin_part to isin_probe

# Q14

Done

# Q16

Done

Error: 
    1. Variable Not Defined (Customer, Complaints). 
        This could be fixed in JointFrame, by adding context_variables from isin_part to isin_probe

# Q15

Done

# Q19

Done

# Q3

Done

# Q10

Done

# Q18

as_part_for_next_join -> probe side is not joint

Done

# Q7

Error: ExtFunc not defined for ExtractYear
