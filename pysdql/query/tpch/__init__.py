import time

import pysdql.query.tpch.Qsdql

import pysdql.query.tpch.Qpandas

from pysdql.query.util import sdql_to_df, pandas_to_df, compare_dataframe

sep_line = '#' * 75


def tpch_query(qindex=1, execution_mode=0, threads_count=1) -> bool:
    done = [1, 3, 4, 6, 14, 15, 16]

    if isinstance(qindex, int):
        if qindex not in done:
            print(f'Query {qindex} has not been verified.')
            return False

        qindex = [qindex]

    if isinstance(qindex, list):
        check_list = []
        for q in qindex:
            if q not in done:
                print(f'Query {q} has not been verified.')
                return False

            print(f'>> Query {q} <<')

            sdql_df = None
            pandas_df = None

            try:
                print(f'>> SDQL <<')

                sdql_result = eval(f'pysdql.query.tpch.Qsdql.q{q}({execution_mode}, {threads_count})')

                sdql_df = sdql_to_df(sdql_result)

                print(sdql_result)

                pandas_result = eval(f'pysdql.query.tpch.Qpandas.q{q}()')

                pandas_df = pandas_to_df(pandas_result)

                print(f'>> Pandas <<')

                print(pandas_result)
            except:
                pass

            if compare_dataframe(sdql_df, pandas_df):
                check_list.append(True)
                print_succ_text(q)
            else:
                check_list.append(False)
                print_fail_text(q)
        else:
            return all(check_list)
    else:
        raise NotImplementedError

def print_succ_text(q):
    print(sep_line)
    print(f'''
    {art_map[q]}
    ███████╗██╗   ██╗ ██████╗ ██████╗███████╗███████╗███████╗
    ██╔════╝██║   ██║██╔════╝██╔════╝██╔════╝██╔════╝██╔════╝
    ███████╗██║   ██║██║     ██║     █████╗  ███████╗███████╗
    ╚════██║██║   ██║██║     ██║     ██╔══╝  ╚════██║╚════██║
    ███████║╚██████╔╝╚██████╗╚██████╗███████╗███████║███████║
    ╚══════╝ ╚═════╝  ╚═════╝ ╚═════╝╚══════╝╚══════╝╚══════╝                                             
    ''')
    print(sep_line)


def print_fail_text(q):
    print(sep_line)
    print(f'''
    {art_map[q]}
       █████ ▄▄▄       ██▓  ██▓    █    ██  ██▀███   ▓█████
     ▓██    ▒████▄   ▒▓██▒ ▓██▒    ██  ▓██▒▓██ ▒ ██▒ ▓█   ▀
     ▒████  ▒██  ▀█▄ ▒▒██▒ ▒██░   ▓██  ▒██░▓██ ░▄█ ▒ ▒███  
     ░▓█▒   ░██▄▄▄▄██░░██░ ▒██░   ▓▓█  ░██░▒██▀▀█▄   ▒▓█  ▄
    ▒░▒█░   ▒▓█   ▓██░░██░▒░██████▒▒█████▓ ░██▓ ▒██▒▒░▒████
    ░ ▒ ░   ░▒▒   ▓▒█ ░▓  ░░ ▒░▓  ░▒▓▒ ▒ ▒ ░ ▒▓ ░▒▓░░░░ ▒░ 
    ░ ░     ░ ░   ▒▒ ░ ▒ ░░░ ░ ▒  ░░▒░ ░ ░   ░▒ ░ ▒ ░ ░ ░  
      ░ ░     ░   ▒  ░ ▒ ░   ░ ░   ░░░ ░ ░   ░░   ░     ░  
    ░             ░    ░  ░    ░     ░        ░     ░   ░  
    ''')
    print(sep_line)


art_map = {
    1: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝
    ''',
    2: '''
    
    ''',
    3: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗    ██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ╚════██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝      █████╔╝
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ╚═══██╗
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║       ██████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝       ╚═════╝ 
    ''',
    4: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗    ██╗  ██╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ██║  ██║
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ███████║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝      ╚════██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║            ██║
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝            ╚═╝

    ''',
    5: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗    ███████╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ██╔════╝
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ███████╗
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝      ╚════██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║       ███████║
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝       ╚══════╝
    ''',
    6: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ██╔════╝ 
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ███████╗ 
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝      ██╔═══██╗
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║       ╚██████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═════╝ 
    ''',
    7: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗    ███████╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ╚════██║
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝        ██╔╝ 
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝        ██╔╝  
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║         ██║   
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝         ╚═╝   
''',
    8: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     █████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ██╔══██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚█████╔╝
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝      ██╔══██╗
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║       ╚█████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚════╝ 
''',
    9: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     █████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ██╔══██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██████║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ╚═══██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        █████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚════╝ 
''',
    10: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗ ██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║██╔═████╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║██║██╔██║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║████╔╝██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║╚██████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝ ╚═════╝ 
''',
    11: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗ ██╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║███║
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║╚██║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║ ██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║ ██║
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝ ╚═╝
''',
    12: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║╚════██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║ █████╔╝
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║██╔═══╝ 
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║███████╗
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝╚══════╝
''',
    13: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║╚════██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║ █████╔╝
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║ ╚═══██╗
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║██████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝╚═════╝ 
''',
    14: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗██╗  ██╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║██║  ██║
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║███████║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║╚════██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║     ██║
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝     ╚═╝
''',
    15: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗███████╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║██╔════╝
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║███████╗
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║╚════██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║███████║
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝╚══════╝
''',
    16: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗ ██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║██╔════╝ 
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║███████╗ 
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║██╔═══██╗
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║╚██████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝ ╚═════╝ 
''',
    17: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗███████╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║╚════██║
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║   ██╔╝ 
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║  ██╔╝  
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║  ██║   
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝  ╚═╝   
''',
    18: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗ █████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║██╔══██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║╚█████╔╝
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║██╔══██╗
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║╚█████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝ ╚════╝ 
''',
    19: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗     ██╗ █████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ███║██╔══██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝     ╚██║╚██████║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝       ██║ ╚═══██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║        ██║ █████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝        ╚═╝ ╚════╝ 
''',
    20: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗    ██████╗  ██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ╚════██╗██╔═████╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝      █████╔╝██║██╔██║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝      ██╔═══╝ ████╔╝██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║       ███████╗╚██████╔╝
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝       ╚══════╝ ╚═════╝ 
''',
    21: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗    ██████╗  ██╗
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ╚════██╗███║
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝      █████╔╝╚██║
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝      ██╔═══╝  ██║
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║       ███████╗ ██║
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝       ╚══════╝ ╚═╝
''',
    22: '''
 ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗    ██████╗ ██████╗ 
██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝    ╚════██╗╚════██╗
██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝      █████╔╝ █████╔╝
██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝      ██╔═══╝ ██╔═══╝ 
╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║       ███████╗███████╗
 ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝       ╚══════╝╚══════╝
''',
}
